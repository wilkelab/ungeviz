<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sampling and bootstrapping • ungeviz</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sampling and bootstrapping">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ungeviz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/misc-geoms-stats.html">Miscellaneous geoms and stats</a>
    </li>
    <li>
      <a href="../articles/posterior-draws.html">Posterior draws from a fitted model</a>
    </li>
    <li>
      <a href="../articles/sampling-bootstrapping.html">Sampling and bootstrapping</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wilkelab/ungeviz">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Sampling and bootstrapping</h1>
                        <h4 class="author">Claus O. Wilke</h4>
            
            <h4 class="date">2019-01-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wilkelab/ungeviz/blob/master/vignettes/sampling-bootstrapping.Rmd"><code>vignettes/sampling-bootstrapping.Rmd</code></a></small>
      <div class="hidden name"><code>sampling-bootstrapping.Rmd</code></div>

    </div>

    
    
<p>The functions <code><a href="../reference/sampler.html">sampler()</a></code> and <code><a href="../reference/bootstrapper.html">bootstrapper()</a></code> generate sampling and bootstrapping objects that are useful in ggplot2 layers. They are meant to sample from data frames and/or bootstrap sample frames.</p>
<div id="sampling-from-data-frames" class="section level2">
<h2 class="hasAnchor">
<a href="#sampling-from-data-frames" class="anchor"></a>Sampling from data frames</h2>
<p>Both <code><a href="../reference/sampler.html">sampler()</a></code> and <code><a href="../reference/bootstrapper.html">bootstrapper()</a></code> return functions that can be applied to data frames to carry out the sampling or bootstrapping. The benefit of using these generated functions is that we can reproducibly sample or bootstrap multiple times. As an exampe of this concept, assume we want to sample three times two rows each (without replacement) from a data frame that holds one row for each letter in the alphabet.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ungeviz)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># sampling object that samples 3 times a sample of size 2</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">spl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampler.html">sampler</a></span>(<span class="dt">times =</span> <span class="dv">3</span>, <span class="dt">size =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># input data frame</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">letter =</span> letters, <span class="dt">number =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">26</span>)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(df)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;   letter number</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; 1      a      1</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; 2      b      2</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; 3      c      3</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; 4      d      4</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; 5      e      5</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; 6      f      6</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co"># resample the data frame</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="kw">spl</span>(df)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; # A tibble: 6 x 6</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; # Groups:   .draw [3]</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;   .draw   .id .original_id letter number  .row</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;        &lt;int&gt; &lt;fct&gt;   &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; 1     1     1           17 q          17     1</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; 2     1     2           24 x          24     2</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; 3     2     1           18 r          18     3</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt; 4     2     2            3 c           3     4</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt; 5     3     1           17 q          17     5</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt; 6     3     2           10 j          10     6</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co"># repeated application of the same sampler object produces the same sample</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="kw">spl</span>(df)</a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#&gt; # A tibble: 6 x 6</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt; # Groups:   .draw [3]</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt;   .draw   .id .original_id letter number  .row</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;        &lt;int&gt; &lt;fct&gt;   &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt; 1     1     1           17 q          17     1</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt; 2     1     2           24 x          24     2</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt; 3     2     1           18 r          18     3</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt; 4     2     2            3 c           3     4</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt; 5     3     1           17 q          17     5</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="co">#&gt; 6     3     2           10 j          10     6</span></a></code></pre></div>
<p>We see that repeated sampling produces the exact same output. We also see that the sampling adds four data columns, called <code>.draw</code>, <code>.id</code>, <code>.original_id</code>, and <code>.row</code>. These provide information about the sampled rows. <code>.draw</code> identifies the repeated draws, <code>.id</code> identifies individual data row within each repeated draw, <code>.original_id</code> identifies the data row from which a sampled row originates, and <code>.row</code> simply counts all rows in the final data frame. All these additional columns can be useful in conjunction with gganimate.</p>
<p>Sampling without replacement is the default. If we want to sample with replacement, we can set the <code>replace</code> argument to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># sampling object that samples once a sample of size 5 with replacement</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">spl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampler.html">sampler</a></span>(<span class="dt">times =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># input data frame</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">letter =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">number =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">df</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;   letter number</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; 1      a      1</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; 2      b      2</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 3      c      3</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; 4      d      4</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># resample the data frame</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="kw">spl</span>(df)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; # A tibble: 5 x 6</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; # Groups:   .draw [1]</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt;   .draw   .id .original_id letter number  .row</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;        &lt;int&gt; &lt;fct&gt;   &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; 1     1     1            1 a           1     1</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; 2     1     2            3 c           3     2</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; 3     1     3            3 c           3     3</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; 4     1     4            4 d           4     4</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; 5     1     5            4 d           4     5</span></a></code></pre></div>
<p>For both sampling and bootstrapping, we can specify groups to sample from or to bootstrap. This can be done either by using the <code>group</code> argument or by applying the sampler or bootstrapper object on a grouped tibble.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">type =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"A"</span>, <span class="dv">100</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"B"</span>, <span class="dv">10</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"C"</span>, <span class="dv">3</span>)),</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">113</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(df)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;   type          y</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; 1    A -1.2070657</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; 2    A  0.2774292</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; 3    A  1.0844412</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; 4    A -2.3456977</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; 5    A  0.4291247</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; 6    A  0.5060559</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co"># sample without considering any grouping</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw"><a href="../reference/sampler.html">sampler</a></span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">seed =</span> <span class="dv">123</span>)(df)</a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; # A tibble: 4 x 6</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; # Groups:   .draw [2]</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;   .draw   .id .original_id type       y  .row</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;        &lt;int&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; 1     1     1           33 A     -0.709     1</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; 2     1     2           89 A     -0.192     2</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; 3     2     1           47 A     -1.11      3</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; 4     2     2           99 A      0.973     4</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co"># sample within groups defined by `type` column</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="kw"><a href="../reference/sampler.html">sampler</a></span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">group =</span> type, <span class="dt">seed =</span> <span class="dv">123</span>)(df)</a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; # A tibble: 12 x 7</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; # Groups:   .draw_group, .draw [6]</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt;    .draw   .id .original_id type        y .draw_group  .row</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;        &lt;int&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;fct&gt;       &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt;  1     1     1           29 A     -0.0151 A               1</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt;  2     1     2           79 A      0.258  A               2</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt;  3     2     1           41 A      1.45   A               3</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt;  4     2     2           88 A     -0.403  A               4</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt;  5     1     1          110 B     -0.0521 B               5</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt;  6     1     2          101 B      0.415  B               6</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt;  7     2     1          106 B      0.167  B               7</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt;  8     2     2          109 B      0.355  B               8</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt;  9     1     1          112 C     -0.649  C               9</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt; 10     1     2          111 C     -0.196  C              10</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt; 11     2     1          113 C     -1.11   C              11</span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="co">#&gt; 12     2     2          111 C     -0.196  C              12</span></a>
<a class="sourceLine" id="cb3-47" data-line-number="47"></a>
<a class="sourceLine" id="cb3-48" data-line-number="48"><span class="co"># sample within groups defined by `type` column</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49"><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(df, type) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/sampler.html">sampler</a></span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">seed =</span> <span class="dv">123</span>)()</a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="co">#&gt; # A tibble: 12 x 6</span></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"><span class="co">#&gt; # Groups:   type, .draw [6]</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="co">#&gt;    .draw   .id .original_id type        y  .row</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;        &lt;int&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="co">#&gt;  1     1     1           29 A     -0.0151     1</span></a>
<a class="sourceLine" id="cb3-55" data-line-number="55"><span class="co">#&gt;  2     1     2           79 A      0.258      2</span></a>
<a class="sourceLine" id="cb3-56" data-line-number="56"><span class="co">#&gt;  3     2     1           41 A      1.45       3</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57"><span class="co">#&gt;  4     2     2           88 A     -0.403      4</span></a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="co">#&gt;  5     1     1          110 B     -0.0521     5</span></a>
<a class="sourceLine" id="cb3-59" data-line-number="59"><span class="co">#&gt;  6     1     2          101 B      0.415      6</span></a>
<a class="sourceLine" id="cb3-60" data-line-number="60"><span class="co">#&gt;  7     2     1          106 B      0.167      7</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61"><span class="co">#&gt;  8     2     2          109 B      0.355      8</span></a>
<a class="sourceLine" id="cb3-62" data-line-number="62"><span class="co">#&gt;  9     1     1          112 C     -0.649      9</span></a>
<a class="sourceLine" id="cb3-63" data-line-number="63"><span class="co">#&gt; 10     1     2          111 C     -0.196     10</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64"><span class="co">#&gt; 11     2     1          113 C     -1.11      11</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65"><span class="co">#&gt; 12     2     2          111 C     -0.196     12</span></a></code></pre></div>
<p>Now let’s make a hypothetical outcome plot (HOP). We will use the <code>cacao</code> dataset, which contains ratings for chocolate bars from manufacturers in many different locations. Let’s make a plot that shows the ratings of randomly drawn pairs of chocolate bars, one from a U.S. manufacturer and one from a Canadian manufacturer. The trick to doing this is to use the appropriate sampler object as the <code>data</code> argument to a layer in ggplot2. This trick makes use of the ggplot2 feature that if <code>data</code> is a function then this function is used to modify the main dataset of the plot for this layer.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gganimate)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">cacao <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(location <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Canada"</span>, <span class="st">"U.S.A."</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(rating, location)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">    <span class="dt">position =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span>(<span class="dt">height =</span> <span class="fl">0.3</span>, <span class="dt">width =</span> <span class="fl">0.05</span>), </a>
<a class="sourceLine" id="cb4-8" data-line-number="8">    <span class="dt">size =</span> <span class="fl">0.4</span>, <span class="dt">color =</span> <span class="st">"#0072B2"</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="../reference/geom_hpline.html">geom_vpline</a></span>(<span class="dt">data =</span> <span class="kw"><a href="../reference/sampler.html">sampler</a></span>(<span class="dv">25</span>, <span class="dt">group =</span> location), <span class="dt">height =</span> <span class="fl">0.6</span>, <span class="dt">color =</span> <span class="st">"#D55E00"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/transition_states">transition_states</a></span>(.draw, <span class="dv">1</span>, <span class="dv">3</span>)</a></code></pre></div>
<p><img src="sampling-bootstrapping_files/figure-html/cacao-ratings-1.gif"><!-- --></p>
<p>By default, gganimate shows the vertical bars sliding from one position to another. If instead we want the bars to disappear and reappear, we need to tell gganimate that it should consider them to be different. We do this by setting the group aesthetic of the vpline layer to <code>.row</code>. Since <code>.row</code> simply counts all rows in the sampled data frame, this group setting guarantees that gganimate thinks of all vertical bars as independent objects.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">cacao <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(location <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Canada"</span>, <span class="st">"U.S.A."</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(rating, location)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    <span class="dt">position =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span>(<span class="dt">height =</span> <span class="fl">0.3</span>, <span class="dt">width =</span> <span class="fl">0.05</span>), </a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    <span class="dt">size =</span> <span class="fl">0.4</span>, <span class="dt">color =</span> <span class="st">"#0072B2"</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/geom_hpline.html">geom_vpline</a></span>(</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">    <span class="dt">data =</span> <span class="kw"><a href="../reference/sampler.html">sampler</a></span>(<span class="dv">25</span>, <span class="dt">group =</span> location),</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">    <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">group =</span> .row), <span class="co"># here is where we set the group aesthetic for vertical bars</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">    <span class="dt">height =</span> <span class="fl">0.6</span>, <span class="dt">color =</span> <span class="st">"#D55E00"</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/transition_states">transition_states</a></span>(.draw, <span class="dv">1</span>, <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/enter_exit">enter_fade</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/enter_exit">exit_fade</a></span>() <span class="co"># smoth enter and exit</span></a></code></pre></div>
<p><img src="sampling-bootstrapping_files/figure-html/cacao-ratings-fade-1.gif"><!-- --></p>
</div>
<div id="bootstrapping-data-frames" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrapping-data-frames" class="anchor"></a>Bootstrapping data frames</h2>
<p>Bootstrapper objects work just like sampler objects. A bootstrapper can be thought of as a special case of a sampler where sampling is done with replacement and the sample size is the group size.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># bootstrapper object that bootstraps 2 times</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">bsr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrapper.html">bootstrapper</a></span>(<span class="dt">times =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># input data frame</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">letter =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">number =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(df)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;   letter number</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; 1      a      1</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; 2      b      2</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; 3      c      3</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 4      d      4</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co"># bootstrap the data frame</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="kw">bsr</span>(df)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; # A tibble: 8 x 7</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; # Groups:   .draw [2]</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt;   .draw   .id .original_id letter number .copies  .row</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;        &lt;int&gt; &lt;fct&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; 1     1     1            4 d           4       2     1</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; 2     1     2            4 d           4       2     2</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; 3     1     3            1 a           1       2     3</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; 4     1     4            1 a           1       2     4</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; 5     2     1            3 c           3       1     5</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; 6     2     2            2 b           2       1     6</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; 7     2     3            4 d           4       1     7</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; 8     2     4            1 a           1       1     8</span></a></code></pre></div>
<p>The columns <code>.draw</code>, <code>.id</code>, <code>.original_id</code>, and <code>.row</code> are the same as generated by a sampler. The column <code>.copies</code> represents the number of times each original id appears in a bootstrapped draw.</p>
<p>The <code>.copies</code> column is useful if we want to make a bootstrap demonstration that shows how often individual data points are oversampled. In this example, we use <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> to plot the copy number of each duplicated point. We also take advantage of the fact that a bootstrapper can be used multiple times with identical results, and hand it as the <code>data</code> argument to multiple layers.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">69527</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># randomly generate dataset</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">15</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(x, <span class="dt">y =</span> x <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">15</span>))</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co"># bootstrapper object</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">bsr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrapper.html">bootstrapper</a></span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">fill =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="dt">label =</span> <span class="st">"0"</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span><span class="op">/</span>.pt) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">data =</span> bsr, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">group =</span> .row), <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">fill =</span> <span class="st">"blue"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="dt">data =</span> bsr, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">label =</span> .copies, <span class="dt">group =</span> .row), <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span><span class="op">/</span>.pt, <span class="dt">color =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="dt">data =</span> bsr, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">group =</span> .draw), <span class="dt">method =</span> <span class="st">"lm"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Bootstrap demonstration"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/transition_states">transition_states</a></span>(.draw, <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/enter_exit">enter_fade</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/enter_exit">exit_fade</a></span>()</a></code></pre></div>
<p><img src="sampling-bootstrapping_files/figure-html/bootstrap-demo-1.gif"><!-- --></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sampling-from-data-frames">Sampling from data frames</a></li>
      <li><a href="#bootstrapping-data-frames">Bootstrapping data frames</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Claus O. Wilke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
